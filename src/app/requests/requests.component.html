<div class="tm-header-placeholder uk-margin-remove-adjacent" style="height: 84px;"></div>
<div class="uk-background-norepeat uk-background-cover uk-background-fixed uk-section uk-padding-remove-bottom uk-flex uk-flex-middle"
     style="background-image: url('https://dl119.madgik.di.uoa.gr/images/Background_images/RDM6.jpg'); box-sizing: border-box; height: 200px">
     <!--style="background-image: url('./assets/imgs/omtd_home_2.jpeg'); box-sizing: border-box; height: 150px">-->
  <div class="uk-position-cover"></div>
  <div class="uk-width-1-1">
    <div class="uk-position-relative">
      <div class="uk-container uk-margin-medium">
        <div class="search_box_bg uk-grid-large uk-flex-middle uk-grid uk-grid-stack" uk-grid="">
          <div class="uk-width-1-1@m uk-first-column">
            <div>
              <div class="search_box_bg" style="text-align:center">
                <div [formGroup]="keywordField" class="uk-align-center uk-margin-top">
                  <input class="uk-input uk-width-2-3 uk-search-field"
                         placeholder="αιτών, χειριστής, υπεύθυνος, έργο, ινστιτούτο" formControlName="keyword">
                  <button class="uk-button-medium uk-button-secondary uk-padding-small" (click)="getSearchResults()"><i class="fa fa-search"></i> Αναζήτηση</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="uk-section-default uk-section uk-section-small uk-padding-remove-bottom" style="min-height: 325px">
  <div class="uk-container uk-container-expand">
    <div class="uk-grid-margin uk-grid uk-grid-stack" uk-grid="">
      <div class="uk-width-1-1@m uk-first-column">

        <!--<h1 class="uk-h3 uk-heading-bullet uk-padding-small uk-margin-remove">{{title}}</h1>-->

        <!-- TOP HELP CONTENT -->
        <help-content #topHelperContent [position]="'top'"
                      [ngClass]="topHelperContent.isPresent()?'uk-margin-medium-top uk-margin-medium-bottom':'clear-style'">
        </help-content>

        <div class="uk-container uk-container-expand uk-margin-medium-top uk-margin-remove">
          <div class="uk-grid">

            <!-- LEFT HELP CONTENT -->
            <!--<aside-help-content #leftHelperContent [position]="'left'"
                                [ngClass]="leftHelperContent.isPresent()?'tm-sidebar uk-width-1-4@m uk-first-column':'clear-style'">
            </aside-help-content>-->
          <div>
            <div [formGroup]="filtersForm"
                 class="uk-card uk-card-body uk-card-secondary sidemenu uk-margin-bottom">

                <div class="uk-margin-bottom">
                    <label for="req-phase" class="filterLabel">Φάση:</label>
                    <select id="req-phase" class="form-control" (change)="choosePhase($event)">
                        <option value="0" [selected]="phaseId===0">Όλες</option>
                        <option value="1" [selected]="phaseId===1">Πρώτη φάση</option>
                        <option value="2" [selected]="phaseId===2">Δεύτερη φάση</option>
                    </select>
                </div>
                <div class="uk-margin-bottom">
                   <div formArrayName="statusChoices" class="show-options uk-inline">
                       <div class="filterLabel">Κατάσταση:</div>
                       <div>
                           <div [formGroupName]="'0'">
                               <label for="pending">
                                   <input class="uk-checkbox" type="checkbox" formControlName="status" id="pending"
                                          (change)="chooseState('pending', $event)">
                                   &nbsp;{{ stateNames['pending'] }}
                               </label>
                           </div>
                           <div [formGroupName]="'1'">
                               <label for="rejected">
                                   <input class="uk-checkbox" type="checkbox" formControlName="status" id="rejected"
                                          (change)="chooseState('rejected', $event)">
                                   &nbsp;{{ stateNames['rejected'] }}
                               </label>
                           </div>
                           <div [formGroupName]="'2'">
                               <label for="accepted">
                                   <input class="uk-checkbox" type="checkbox" formControlName="status" id="accepted"
                                          (change)="chooseState('rejected', $event)">
                                   &nbsp;{{ stateNames['accepted'] }}
                               </label>
                           </div>
                       </div>
                   </div>
               </div>
               <div *ngIf="!isSimpleUser" class="uk-margin-bottom ">
                   <div formArrayName="stageChoices" class="show-options uk-inline">
                       <div class="filterLabel">Στάδιο:</div>
                       <div *ngFor="let stage of stages; let stage_i = index">
                           <div [formGroupName]="stage_i">
                               <label for="stage_{{ stage_i }}">
                                   <input class="uk-checkbox" type="checkbox" formControlName="stage" id="stage_{{ stage_i }}"
                                          (change)="chooseStage(stage, $event)">
                                   &nbsp;{{ stagesMap[stage] }}
                               </label>
                           </div>
                       </div>
                   </div>
               </div>
               <button class="uk-button uk-button-default" type="reset" (click)="clearFilterControls()">Καθάρισμα επιλογών</button>

           </div>
          </div>

              <!-- MIDDLE -->
            <div class=" uk-width-expand@m">

                <!--<div class="uk-form-horizontal uk-margin-large">-->
                    <!--<div [formGroup]="keywordField" class="uk-width-1-2 uk-align-center uk-margin-top">-->
                        <!--<input class="uk-input uk-width-2-3 uk-search-field"-->
                               <!--placeholder="αιτών, χειριστής, υπεύθυνος, έργο, ινστιτούτο" formControlName="keyword">-->
                        <!--<button class="uk-button-medium uk-button-secondary uk-padding-small" (click)="getSearchResults()">Αναζήτηση</button>-->
                    <!--</div>-->
                <!--</div>-->
                <div>
                    <div *ngIf="errorMessage" class="uk-alert uk-alert-warning">{{errorMessage}}</div>
                    <div *ngIf="showSpinner" class="uk-inline uk-position-center uk-padding-large-top">
                        <div class="uk-overlay-default uk-position-cover"></div>
                        <div uk-spinner="ratio: 2" class="uk-overlay uk-dark"></div>
                    </div>

                    <div *ngIf="searchResults">
                        <div class="uk-grid page-controls uk-flex-right">
                            <div class="uk-margin-bottom ">
                                <div class="show-options uk-inline">
                                    <div class="filterLabel">Αιτήσεις ανά σελίδα:</div>
                                    <div class="inlineBlock">
                                        <select id="req-pagesize" class="form-control" (change)="getItemsPerPage($event)">
                                            <option value="10" selected>10</option>
                                            <option value="25">25</option>
                                            <option value="50">50</option>
                                            <option value="100">100</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="contentAndPagerPanel">

                            <div class="uk-width-1-1 uk-margin-top uk-padding-top uk-padding-remove-bottom">
                                <!-- Paging-top -->
                                <div class="uk-width-1-1 uk-align-center">
                                    <ul class="uk-pagination uk-padding-small uk-padding-remove-bottom">
                                        <li>
                                            <a class="uk-link uk-link-muted" (click)="goToPreviousPage()">
                                                <span class="uk-margin-small-right uk-pagination-previous uk-icon" uk-pagination-previous="">
                                                    <svg width="7" height="12" viewBox="0 0 7 12" xmlns="http://www.w3.org/2000/svg"
                                                         icon="pagination-previous" ratio="1"></svg>
                                                </span>
                                                Previous
                                            </a>
                                        </li>

                                        <li class="uk-margin-auto-left">
                                            <div class="resultsPageLabel" style="all: unset; font-size: small">page {{ (totalPages > 0) ? currentPage+1 : 0 }} of {{ totalPages }}</div>
                                        </li>

                                        <li class="uk-margin-auto-left">
                                            <a class="uk-link uk-link-muted" (click)="goToNextPage()">
                                                Next
                                                <span class="uk-margin-small-left uk-pagination-next uk-icon" uk-pagination-next="">
                                                    <svg width="7" height="12" viewBox="0 0 7 12" xmlns="http://www.w3.org/2000/svg"
                                                         icon="pagination-next" ratio="1"></svg>
                                                </span>
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                            </div>

                            <div>
                                <div *ngIf="listOfRequests" class="uk-width-1-1 uk-overflow-auto uk-scrollspy-inview uk-animation-slide-top-medium uk-margin-top uk-margin-bottom">
                                    <table class="uk-table uk-table-hover uk-table-divider">
                                        <thead>
                                            <tr>
                                                <th>Αρ.Πρωτοκολλου</th>
                                                <th>Ειδος</th>
                                                <th><a (click)="sortBy('request_project')" title="Ταξινόμηση με βάση το ακρώνυμο του έργου">
                                                    Εργο&nbsp;
                                                    <span *ngIf="orderField && (orderField === 'request_project')"
                                                          [innerHtml]="getOrderSign()"></span>
                                                    </a>
                                                </th>
                                                <th><a (click)="sortBy('request_institute')" title="Ταξινόμηση με βάση το όνομα του Ινστιτούτου ή της Μονάδας" class="uk-margin-large-right">
                                                    Ινστιτουτο / Μοναδα
                                                    <span *ngIf="orderField && (orderField === 'request_institute')"
                                                          [innerHtml]="getOrderSign()"></span>
                                                </a></th>

                                                <th>Αιτων</th>
                                                <th><a (click)="sortBy('creation_date')" title="Ταξινόμηση με βάση την ημερομηνία υποβολής του αιτήματος">
                                                    Ημ/νια&nbsp;
                                                    <span *ngIf="orderField && (orderField === 'creation_date')"
                                                          [innerHtml]="getOrderSign()"></span>
                                                    </a>
                                                </th>
                                                <th *ngIf="!isSimpleUser"><a (click)="sortBy('request_stage')" title="Ταξινόμηση με βάση το στάδιο" class="uk-margin-right">
                                                    Σταδιο&nbsp;
                                                    <span *ngIf="orderField && (orderField === 'request_stage')"
                                                          [innerHtml]="getOrderSign()"></span>
                                                    </a>
                                                </th>
                                                <th><span class="uk-margin-right">Κατασταση</span></th>
                                                <th></th>
                                            </tr>
                                            <tr *ngIf="noRequests">
                                                <td colspan="8" class="uk-alert uk-width-1-1">{{noRequests}}</td>
                                            </tr>
                                            <tr class="uk-link" *ngFor="let req of listOfRequests"
                                                (click)="navigateToRequestPage(req.baseInfo)"
                                                title="Μετάβαση στην σελίδα του αιτήματος">
                                                <td>{{ req.baseInfo.id }}</td>
                                                <td>{{ reqTypes[req.request.type] }}</td>
                                                <td>{{ req.request.project.acronym }}</td>
                                                <td>{{ req.request.project.institute.name }}</td>
                                                <td>{{ req.request.user.firstname }} {{ req.request.user.lastname }}</td>
                                                <td>{{ req.request.stage1.requestDate | date : 'dd-MM-yyyy' }}</td>
                                                <td *ngIf="!isSimpleUser" >{{ stagesMap[req.baseInfo.stage] }}</td>
                                                <td>{{ getStatusAsString(req.baseInfo.status) }}</td>
                                                <td>
                                                    <span *ngIf="getIfUserCanEdit(req.request.id, req.request.project, req.baseInfo.stage)">
                                                           <i class="fa fa-pencil"></i>
                                                    </span>
                                                </td>
                                            </tr>
                                        </thead>
                                    </table>
                                </div>
                            </div>

                            <div class="uk-width-1-1 uk-margin-top uk-padding-top uk-padding-remove-top">
                                <!-- Paging-bottom -->
                                <div class="uk-width-1-1 uk-align-center">
                                    <ul class="uk-pagination uk-padding-small uk-padding-remove-top">
                                        <li>
                                            <a class="uk-link uk-link-muted" (click)="goToPreviousPage()">
                                                <span class="uk-margin-small-right uk-pagination-previous uk-icon" uk-pagination-previous="">
                                                    <svg width="7" height="12" viewBox="0 0 7 12" xmlns="http://www.w3.org/2000/svg"
                                                         icon="pagination-previous" ratio="1"></svg>
                                                </span>
                                                Previous
                                            </a>
                                        </li>

                                        <li class="uk-margin-auto-left">
                                            <div class="resultsPageLabel" style="all: unset; font-size: small">page {{ (totalPages > 0) ? currentPage+1 : 0 }} of {{ totalPages }}</div>
                                        </li>

                                        <li class="uk-margin-auto-left">
                                            <a class="uk-link uk-link-muted" (click)="goToNextPage()">
                                                Next
                                                <span class="uk-margin-small-left uk-pagination-next uk-icon" uk-pagination-next="">
                                                    <svg width="7" height="12" viewBox="0 0 7 12" xmlns="http://www.w3.org/2000/svg"
                                                         icon="pagination-next" ratio="1"></svg>
                                                </span>
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                            </div>

                        </div>

                    </div>

                </div>

            </div>

            <!-- RIGHT HELP CONTENT -->
            <aside-help-content #rightHelperContent [position]="'right'"
                                [ngClass]="rightHelperContent.isPresent()?'tm-sidebar uk-width-1-4@m uk-first-column':'clear-style'">
            </aside-help-content>

          </div>
        </div>


        <!-- BOTTOM HELP CONTENT -->
        <help-content #bottomHelperContent [position]="'bottom'"
                      [ngClass]="bottomHelperContent.isPresent()?'uk-margin-medium-top uk-margin-medium-bottom':'clear-style'">
        </help-content>


      </div>
    </div>
  </div>
</div>
