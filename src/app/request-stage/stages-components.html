<!-- OLD STAGES HTML -->

<div *ngIf="showStage || (!showStage && (hasReturnedToPrevious===1))" class="uk-width-1-1 uk-margin-bottom">
    <hr>
    <div *ngIf="wasSubmitted" class="uk-form-controls">
        <h5>{{ stageTitle }}</h5>
        <div>
            {{ wasApproved }}
             {{ delegatePositionInParagraph }}
             ({{ getDelegateName() }})
             στις {{ currentStage['date'] | date : 'dd-MM-yyyy' }}
        </div>
        <div *ngIf="stageDescription.id !== '3'">
            <div *ngFor="let desc of stageDescription.stageFields; let controlIndex = index">
                <app-stage-form [description]="desc">
                    <div *ngIf="desc.type === 'checkbox'">
                        <input class="uk-form-controls uk-checkbox"
                               type="checkbox" [checked]="currentStage[ stageExtraFieldsList[controlIndex] ]" disabled>
                    </div>
                    <div *ngIf="desc.type === 'text'">
                        <input value="{{currentStage[ stageExtraFieldsList[controlIndex] ]}}" disabled
                               class="uk-form-controls uk-input" type="text">
                    </div>
                    <div *ngIf="desc.type === 'textarea'">
                        <textarea value="{{currentStage[ stageExtraFieldsList[controlIndex] ]}}" disabled
                                  class="uk-form-controls uk-textarea" rows="2"></textarea>
                    </div>
                </app-stage-form>
            </div>
        </div>
        <div *ngIf="stageDescription.id === '3'">
            <div class="uk-grid uk-margin-small-top">
                <label class="uk-width-1-3">Έχει αναληφθεί η υποχρέωση;</label>
                <div class="uk-width-expand">
                    <input class="uk-form-controls uk-checkbox"
                           type="checkbox" [checked]="currentStage['analiftheiYpoxrewsi']" disabled>
                </div>
            </div>
            <div class="uk-grid uk-margin-small-top">
                <label class="uk-width-1-3">Υπάρχει διαθέσιμη πίστωση;</label>
                <div class="uk-width-expand">
                    <input class="uk-form-controls uk-checkbox"
                           type="checkbox" [checked]="currentStage['fundsAvailable']" disabled>
                </div>
            </div>
            <div class="uk-grid uk-margin-small-top">
                <label class="uk-width-1-3">Έγινε δανεισμός</label>
                <div class="uk-width-expand">
                    <input class="uk-form-controls uk-checkbox"
                           type="checkbox" [checked]="currentStage['loan']" disabled>
                </div>
            </div>
            <div class="uk-grid uk-margin-small-top">
                <label class="uk-width-1-3">Από</label>
                <div class="uk-width-expand">
                    <input value="{{currentStage['loanSource']}}" disabled class="uk-form-controls uk-input" type="text">
                </div>
            </div>
        </div>
        <div *ngIf="currentStage['comment']">
            <span class="uk-text-bold uk-margin-small-right">Σχόλια: </span>
            <span> {{ currentStage['comment'] }} </span>
        </div>
        <div *ngIf="currentStage['attachment']">
            <a class="uk-link uk-width-1-1@l uk-margin-small-top" (click)="linkToFile()">
                Πατήστε εδώ για να κατεβάσετε τα σχετικά αρχεία
            </a>
        </div>
    </div>
    <div *ngIf="!wasSubmitted && stageForm" [formGroup]="stageForm" class="uk-form-controls stageForm">
        <h5>{{ stageTitle }}</h5>

        <div *ngIf="stageFormError" class="uk-alert uk-alert-error">{{ stageFormError }}</div>
        <!--INPUTS FOR EXTRA FIELDS-->
        <div *ngIf="stageDescription.id !== '3'">
            <div *ngFor="let desc of stageDescription.stageFields; let controlIndex = index">
                <app-stage-form [description]="desc">
                    <div *ngIf="desc.type === 'checkbox'">
                        <input formControlName="{{stageExtraFieldsList[controlIndex]}}"
                               class="uk-form-controls uk-checkbox" type="checkbox">
                    </div>
                    <div *ngIf="desc.type === 'text'">
                        <input formControlName="{{stageExtraFieldsList[controlIndex]}}"
                               class="uk-form-controls uk-input" type="text">
                    </div>
                    <div *ngIf="desc.type === 'textarea'">
                        <textarea formControlName="{{stageExtraFieldsList[controlIndex]}}"
                                  class="uk-form-controls uk-textarea" rows="2"></textarea>
                    </div>
                </app-stage-form>
            </div>
        </div>
        <div *ngIf="stageDescription.id === '3'">
            <div class="uk-grid uk-margin-small-top">
                <label class="uk-width-1-3">Έχει αναληφθεί η υποχρέωση;</label>
                <div class="uk-width-expand">
                    <input class="uk-form-controls uk-checkbox" type="checkbox" formControlName="analiftheiYpoxrewsi">
                </div>
            </div>
            <div class="uk-grid uk-margin-small-top">
                <label class="uk-width-1-3">Υπάρχει διαθέσιμη πίστωση;</label>
                <div class="uk-width-expand">
                    <input class="uk-form-controls uk-checkbox" type="checkbox" formControlName="fundsAvailable">
                </div>
            </div>
            <div class="uk-grid uk-margin-small-top">
                <label class="uk-width-1-3">Έγινε δανεισμός</label>
                <div class="uk-width-expand">
                    <input class="uk-form-controls uk-checkbox" type="checkbox" formControlName="loan">
                </div>
            </div>
            <div class="uk-grid uk-margin-small-top">
                <label class="uk-width-1-3">Από</label>
                <div class="uk-width-expand">
                    <input formControlName="loanSource" class="uk-form-controls uk-input" type="text">
                </div>
            </div>
        </div>

        <!-- COMMENT FIELD -->
        <app-stage-form [description]="commentFieldDesc">
            <textarea formControlName="comment" class="uk-form-controls uk-textarea" rows="2"></textarea>
        </app-stage-form>

        <!--ATTACHMENT FIELD-->
        <app-stage-form-upload-file [uploadedFilename]="uploadedFilename" (emitFile)="getAttachmentInput($event)"></app-stage-form-upload-file>

        <!--BUTTONS-->
        <div *ngIf="stageDescription.id !== '6' && stageDescription.id !== '11'">
            <button class="uk-button uk-button-primary" (click)="approveRequest(true)">Εγκρίνεται</button>

            <!-- NOT USED ANYMORE -->
            <!--<button *ngIf="willShowButtonTo5a"
                    class="uk-button uk-button-primary" (click)="forwardRequest('5a', true)">Προωθείται προς τον Γενικό Διευθυντή</button>
            <button *ngIf="willShowButtonTo5b"
                    class="uk-button uk-button-primary" (click)="forwardRequest('5b', willShowButtonTo5a)">
                {{ willShowButtonTo5a ? 'Προωθείται προς το Διοικητικό Συμβούλιο': 'Εγκρίνεται' }}</button>-->

            <button class="uk-button uk-button-primary" (click)="approveRequest(false)">Απορρίπτεται</button>
            <button *ngIf="stageDescription.id !== '2'" class="uk-button uk-button-primary" (click)="goBackOneStage()">Επιστροφή στο προηγούμενο στάδιο</button>
        </div>
        <div *ngIf="stageDescription.id === '6' || stageDescription.id === '11'">
            <button class="uk-button uk-button-primary" (click)="submitForm()">Προώθηση αιτήματος</button>
            <button class="uk-button uk-button-primary" (click)="goBackOneStage()">Επιστροφή στο προηγούμενο στάδιο</button>
        </div>
        <div><span class="uk-text-small">Ημερομηνία: {{ getCurrentDateString() }}</span></div>

        <!-- MODAL -->
        <!-- NOT USED ANYMORE -->
        <!--<div id="nextStage" uk-modal>
            <div class="uk-modal-dialog uk-modal-body">
                <h4 class="uk-modal-title uk-h4">Προώθηση αιτήματος</h4>
                <div class="uk-modal-body">Το αίτημα θα σταλεί προς έγκριση {{ nextStageDelegate }}</div>
                <button class="uk-button uk-button-primary" type="button" (click)="onConfirm($event)">Επιβεβαίωση</button>
                <button class="uk-button uk-button-primary uk-modal-close" type="button">Άκυρο</button>
            </div>
        </div>-->
    </div>
</div>

